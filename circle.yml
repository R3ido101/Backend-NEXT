machine:
  node:
    version: 6.9.1

dependencies:
  pre:
    - "rm -rf node_modules/sqlite3"
    - npm install
  override:
    - npm run build
  cache_directories:
    - "node_modules"
    - /opt/circleci/nodejs/v6.9.1/lib/node_modules

test:
  override:
     - npm run lint
     - npm run test:clean
     - npm run test

deployment:
  beta:
    branch: develop
    commands:
      - npm publish --tag next
  release:
    branch: master
    commands:
      - npm publish

general:
  branches:
    only:
      - /feature\/.*/
      - /release\/.*/
      - /hotfix\/.*/
      - master
      - develop
